(()=>{"use strict";const e=function(e,t,n){const o=document.createElement("div");o.classList.add("note");const a=document.createElement("h2");a.innerText=e,a.classList.add("title"),a.setAttribute("contenteditable","true");const c=document.createElement("p");c.innerText=t,c.setAttribute("contenteditable","true"),c.classList.add("content");const i=document.createElement("div");i.classList.add("remove-button");const s=document.createElement("div");return s.classList.add("save-changes-button"),s.innerText="Save",s.addEventListener("click",()=>{o.removeChild(s),o.dataset.modified=!1,o.dispatchEvent(new Event("notechange",{bubbles:!0}))}),o.appendChild(a),o.appendChild(c),o.appendChild(i),o.dataset.id=n,o.dataset.modified=!1,o.addEventListener("input",e=>{o.dataset.modified&&(o.dataset.modified=!0,o.appendChild(s))}),o},t=function(t,...n){const o=document.querySelector(".notes-container");t&&(o.innerHTML=""),n.forEach(t=>{o.appendChild(e(t.Title,t.Content,t.ID))})};document.addEventListener("DOMContentLoaded",async()=>{try{const e=await async function(e){const t=await fetch(`/notes/${e}/`);return JSON.parse(JSON.stringify(await t.json()))}("Nicolas");t(!1,...e)}catch(e){console.log("Could not connect to the api"),console.log(e)}});const n=document.querySelector(".form");n.addEventListener("submit",async e=>{if(e.preventDefault(),!n.reportValidity())return;const o=n.querySelector("#title"),a=n.querySelector("#content");let c;try{c=await async function(e,t,n){return(await fetch("/notes/",{method:"POST",header:{"Content-Type":"application/json"},body:JSON.stringify({Title:t,Content:n,Author:e})})).json()}("Nicolas",o.value,a.value)}catch(e){console.log("Error occured when making a request to the api"),console.log(e)}o.value="",a.value="",t(!1,c)}),n.addEventListener("keypress",e=>{if("Enter"===e.key&&(e.shiftKey&&(e.target.form.dispatchEvent(new Event("submit",{cancelable:!0})),e.preventDefault()),e.target instanceof HTMLInputElement)){e.preventDefault();const t=e.target.parentElement.nextSibling.nextSibling.querySelector(".form-input");t instanceof HTMLElement&&t.focus()}}),document.querySelector(".notes-container").addEventListener("click",async e=>{const t=e.target;if(!t.classList.contains("remove-button"))return;const n=t.closest(".note");try{await async function(e){const t=await fetch(`/notes/${e}/`,{method:"DELETE"});return await t.json()}(n.dataset.id)}catch(e){return console.log("Could not make the request to delete the note"),void console.log(e)}!function(e){document.querySelector(".notes-container").removeChild(e)}(n)}),document.addEventListener("notechange",async t=>{const n=t.target,o=n.dataset.id,a=n.querySelector(".title").innerText,c=n.querySelector(".content").innerText;let i;try{i=await async function(e,t,n){const o=await fetch(`/notes/${e}/`,{method:"PUT",body:JSON.stringify({Title:t,Content:n})});return await o.json()}(o,a,c)}catch(e){return console.log("Could not make the request to delete the note"),void console.log(e)}!function(t){const n=document.querySelector(".notes-container"),o=e(t.Title,t.Content,t.ID),a=n.querySelector(`[data-id="${t.ID}"]`);n.replaceChild(o,a)}(i)})})();